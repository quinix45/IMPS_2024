xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_10 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_10",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_10,
weight_2mpl_10,
weight_GLLla_10,
weight_GLLua_10,
nrow = 2)
final_plot_10 <- grid.arrange(
combined_plot,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png", plot = final_plot_10, width = 8, height = 6, dpi = 300)
####### Grid Plot for weights from I = 20 Conditions ########
weight_2pl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_20",
title = "2PL")
weight_2mpl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2mpl_20",
title = "2MPL")
weight_GLLla_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_la_20",
xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_20",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_20,
weight_2mpl_20,
weight_GLLla_20,
weight_GLLua_20,
nrow = 2)
final_plot_20 <- grid.arrange(
combined_plot,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_20_items.png", plot = final_plot_20, width = 8, height = 6, dpi = 300)
library(tidyverse,
quietly = TRUE)
library(cowplot,
quietly = TRUE)
library(gridExtra,
quietly = TRUE)
theme_set(theme_classic())
library(extrafont)
loadfonts(device="win")
par(family = "Times New Roman")
weights_full <- readRDS("weights_full.RDS")
col_pallet <- c("#999999",
"#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#271DEB")
weight_plot <- function(weight_data,
cond_datagen,
xlab = "Condition",
ylab = "Weight",
title,
legend_pos = "none")
{
plot <- weight_data %>%
filter(condition_datgen == cond_datagen) %>%
ggplot(aes(x = weight_sample,
y = mean,
fill = model)) +
geom_col(width = .7) +
labs(title = title,
x = xlab,
y = ylab) +
scale_fill_manual(values = col_pallet) +
scale_x_discrete(labels=c(bquote(atop("BMA",
"("*italic(N)*" = 100)")),
bquote(atop("BMA",
"("*italic(N)*" = 250)")),
bquote(atop("Stack",
"("*italic(N)*" = 100)")),
bquote(atop("Stack",
"("*italic(N)*" = 250)")))) +
theme(text = element_text(family = "Times New Roman",
size = 12,
colour = "black"),
axis.text.x = element_text(size = 9),
plot.title = element_text(hjust = 0.5),
legend.position = legend_pos,
panel.background = element_rect(fill='transparent'),
plot.background = element_rect(fill='transparent', color=NA),
legend.background = element_rect(fill='transparent')
legend.title.position = "top",
library(tidyverse,
quietly = TRUE)
library(cowplot,
quietly = TRUE)
library(gridExtra,
quietly = TRUE)
theme_set(theme_classic())
library(extrafont)
loadfonts(device="win")
par(family = "Times New Roman")
weights_full <- readRDS("weights_full.RDS")
col_pallet <- c("#999999",
"#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#271DEB")
weight_plot <- function(weight_data,
cond_datagen,
xlab = "Condition",
ylab = "Weight",
title,
legend_pos = "none")
{
plot <- weight_data %>%
filter(condition_datgen == cond_datagen) %>%
ggplot(aes(x = weight_sample,
y = mean,
fill = model)) +
geom_col(width = .7) +
labs(title = title,
x = xlab,
y = ylab) +
scale_fill_manual(values = col_pallet) +
scale_x_discrete(labels=c(bquote(atop("BMA",
"("*italic(N)*" = 100)")),
bquote(atop("BMA",
"("*italic(N)*" = 250)")),
bquote(atop("Stack",
"("*italic(N)*" = 100)")),
bquote(atop("Stack",
"("*italic(N)*" = 250)")))) +
theme(text = element_text(family = "Times New Roman",
size = 12,
colour = "black"),
axis.text.x = element_text(size = 9),
plot.title = element_text(hjust = 0.5),
legend.position = legend_pos,
panel.background = element_rect(fill='transparent'),
plot.background = element_rect(fill='transparent', color=NA),
legend.background = element_rect(fill='transparent'),
legend.title.position = "top",
legend.title = element_text(hjust = 0.5)) +
guides(fill = guide_legend(ncol = 6,
title = "Model"))
return(plot)
}
####### Get legend ########
leg_plot <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_10",
title = "2PL",
legend_pos = "bottom")
get_only_legend <- function(plot)
{
plot_table <- ggplot_gtable(ggplot_build(plot))
legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
legend <- plot_table$grobs[[legend_plot]]
return(legend)
}
legend <- get_only_legend(leg_plot)
####### Grid Plot for weights from I = 10 Conditions ########
weight_2pl_10 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_10",
title = "2PL")
weight_2mpl_10 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2mpl_10",
title = "2MPL")
weight_GLLla_10 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_la_10",
xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_10 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_10",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_10,
weight_2mpl_10,
weight_GLLla_10,
weight_GLLua_10,
nrow = 2)
final_plot_10 <- grid.arrange(
combined_plot,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png", plot = final_plot_10, width = 8, height = 6, dpi = 300)
####### Grid Plot for weights from I = 20 Conditions ########
weight_2pl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_20",
title = "2PL")
weight_2mpl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2mpl_20",
title = "2MPL")
weight_GLLla_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_la_20",
xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_20",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_20,
weight_2mpl_20,
weight_GLLla_20,
weight_GLLua_20,
nrow = 2)
final_plot_20 <- grid.arrange(
combined_plot,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_20_items.png", plot = final_plot_20, width = 8, height = 6, dpi = 300)
weight_2pl_10 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_10",
title = "2PL")
print(weight_2pl_10)
ggsave(filename = "Weights_10.png", weight_2pl_10, width = 8, height = 6, dpi = 300)
final_plot_10 <- grid.arrange(
combined_plot,
newpage=FALSE,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png", plot = final_plot_10, width = 8, height = 6, dpi = 300)
png(bg = "transparent")
png(bg = "transparent")
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
width = 8,
height = 6,
dpi = 300)
png(bg = "wheat1")
final_plot_10
dev.off()
dev.off()
print(final_plot_10 )
print(final_plot_10 )
plot(final_plot_10 )
final_plot_10
ggsave(filename = "plt.png",
plot = combined_plot,
width = 8,
height = 6,
dpi = 300)
View(combined_plot)
combined_plot[["grobs"]][[2]]
combined_plot[["grobs"]][[4]]
View(weight_2mpl_10)
grid.newpage()
library(gridExtra)
# Set up the grid layout
grid_arrange <- function(..., background = "transparent") {
# Open a new device with a transparent background
grid.newpage()
grid.rect(gp = gpar(fill = background, col = NA))
# Call grid.arrange() with the arguments passed
grid.arrange(...)
}
combined_plot <- grid.arrange(weight_2pl_10,
weight_2mpl_10,
weight_GLLla_10,
weight_GLLua_10,
nrow = 2)
final_plot_10 <- grid.arrange(
combined_plot,
newpage=FALSE,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
width = 8,
height = 6,
dpi = 300)
plot1 <- ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
geom_point()
plot2 <- ggplot(data = mtcars, aes(x = wt, y = mpg)) +
geom_point()
# Using the modified grid_arrange() function
pl_t <- grid_arrange(plot1, plot2, ncol = 2)
library(gridExtra)
plot1 <- ggplot(data = iris, aes(x = Sepal.Length, y = Sepal.Width)) +
geom_point()
plot2 <- ggplot(data = mtcars, aes(x = wt, y = mpg)) +
geom_point()
# Using the modified grid_arrange() function
pl_t <- grid_arrange(plot1, plot2, ncol = 2)
combined_plot <- grid.arrange(weight_2pl_10,
weight_2mpl_10,
weight_GLLla_10,
weight_GLLua_10,
nrow = 2)
final_plot_10 <- grid.arrange(
combined_plot,
newpage=FALSE,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
width = 8,
height = 6,
dpi = 300)
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
bg = "black",
width = 8,
height = 6,
dpi = 300)
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
bg = "transparent",
width = 8,
height = 6,
dpi = 300)
library(tidyverse,
quietly = TRUE)
library(cowplot,
quietly = TRUE)
library(gridExtra,
quietly = TRUE)
theme_set(theme_classic())
library(extrafont)
loadfonts(device="win")
par(family = "Times New Roman")
weights_full <- readRDS("weights_full.RDS")
col_pallet <- c("#999999",
"#E69F00",
"#56B4E9",
"#009E73",
"#F0E442",
"#0072B2",
"#D55E00",
"#CC79A7",
"#271DEB")
weight_plot <- function(weight_data,
cond_datagen,
xlab = "Condition",
ylab = "Weight",
title,
legend_pos = "none")
{
plot <- weight_data %>%
filter(condition_datgen == cond_datagen) %>%
ggplot(aes(x = weight_sample,
y = mean,
fill = model)) +
geom_col(width = .7) +
labs(title = title,
x = xlab,
y = ylab) +
scale_fill_manual(values = col_pallet) +
scale_x_discrete(labels=c(bquote(atop("BMA",
"("*italic(N)*" = 100)")),
bquote(atop("BMA",
"("*italic(N)*" = 250)")),
bquote(atop("Stack",
"("*italic(N)*" = 100)")),
bquote(atop("Stack",
"("*italic(N)*" = 250)")))) +
theme(text = element_text(family = "Times New Roman",
size = 12,
colour = "black"),
axis.text.x = element_text(size = 9),
plot.title = element_text(hjust = 0.5),
legend.position = legend_pos,
panel.background = element_rect(fill='transparent'),
plot.background = element_rect(fill='transparent', color=NA),
legend.background = element_rect(fill='transparent'),
legend.title.position = "top",
legend.title = element_text(hjust = 0.5)) +
guides(fill = guide_legend(ncol = 6,
title = "Model"))
return(plot)
}
####### Get legend ########
leg_plot <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_10",
title = "2PL",
legend_pos = "bottom")
get_only_legend <- function(plot)
{
plot_table <- ggplot_gtable(ggplot_build(plot))
legend_plot <- which(sapply(plot_table$grobs, function(x) x$name) == "guide-box")
legend <- plot_table$grobs[[legend_plot]]
return(legend)
}
legend <- get_only_legend(leg_plot)
####### Grid Plot for weights from I = 10 Conditions ########
weight_2pl_10 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_10",
title = "2PL")
weight_2mpl_10 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2mpl_10",
title = "2MPL")
weight_GLLla_10 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_la_10",
xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_10 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_10",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_10,
weight_2mpl_10,
weight_GLLla_10,
weight_GLLua_10,
nrow = 2)
final_plot_10 <- grid.arrange(
combined_plot,
newpage=FALSE,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_10_items.png",
plot = final_plot_10,
bg = "transparent",
width = 8,
height = 6,
dpi = 300)
####### Grid Plot for weights from I = 20 Conditions ########
weight_2pl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2pl_20",
title = "2PL")
weight_2mpl_20 <- weight_plot(weight_data = weights_full,
xlab = "",
ylab = "",
cond_datagen = "2mpl_20",
title = "2MPL")
weight_GLLla_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_la_20",
xlab = "",
ylab = "",
title = bquote(GLL[la]))
weight_GLLua_20 <- weight_plot(weight_data = weights_full,
cond_datagen = "2GLL_ua_20",
xlab = "",
ylab = "",
title = bquote(GLL[ua]))
unique(weights_full$condition_datgen)
combined_plot <- grid.arrange(weight_2pl_20,
weight_2mpl_20,
weight_GLLla_20,
weight_GLLua_20,
nrow = 2)
final_plot_20 <- grid.arrange(
combined_plot,
bg = "transparent",
legend,
nrow = 2,
heights = c(.9, .1))
final_plot_20 <- grid.arrange(
combined_plot,
legend,
nrow = 2,
heights = c(.9, .1))
ggsave(filename = "Weights_20_items.png",
plot = final_plot_20,
bg = "transparent",
width = 8, height = 6, dpi = 300)
setwd("C:/Users/fabio/OneDrive - Fordham University/Desktop/Work/Papers/Model averaging/IMPS_2024/images")
<center>
